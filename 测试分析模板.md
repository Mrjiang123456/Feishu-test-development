# 测试分析模板

## 一、需求背景

> 为什么要做这个需求，需求期望产生的价值
>
> 需求PRD文档、设计稿等文档链接



## 二、需求分析

### 1、用户使用场景（用户故事）

> 1. 用户故事是什么？
>
> 用户故事是描述对用户有价值的功能，好的用户故事应该包括==用户角色、功能和商业价值==三个要素，用户故事通常的两个角度：
>
> **用户角度：**作为一个<某个角色用户>，我想要<某些功能>，以便达到<某些目的>。
>
> **产品价值链角度：**为了<获取某些价值>，作为<某个身份的用户>，应该要有<某些功能>。
>
> 一个好的用户故事包括三个要素：
>
> - 角色：谁要使用这个功能。
> - 功能：需要完成什么样的功能。
> - 价值：为什么需要这个功能，or 这个功能带来什么样的产品价值。
>
> 2. 制定用户故事的两个角度，三个要素
>
> 两个角度：==用户角度，产品价值链角度==
>
> 三个要素：==用户角色；用户场景；产品核心路径==
>
> - 用户类型（依据产品的不同侧重）
>   - 新用户、普通用户、达人作者用户、主播用户、金主用户…
> - 用户场景（依据产品的不同确定）
> - 产品核心路径（依据产品的不同）
>
> 3. 为什么使用用户故事？
>
> - 用户故事强调用户角度
>   - 用户故事的一个核心在于用户角度，列出每个对于用户较为重要的操作路径list，避免QA测试时惯性跑case的情况，能以用户的角度感受产品。
>   - 用户角度的设定不同，容易发现不同用户操作路径下的问题，并且这些路径都是用户的主要场景，是一个产品最核心的操作路径。
> - 用户故事强调产品价值链
>   - 用户故事的另一个核心应该能够体现产品价值，是现阶段该产品的核心价值链的操作路径和场景。
> - 人人都可以理解用户故事
>   - 用户故事使用一两句简洁明了的日常语言写成，并且展示给使用者，不涉及专业的技术术语，从而使得PM/RD/QA 理解起来都很容易，方便新人快速了解产品，并上手测试。
> - 用户故事适合于迭代发版的回归测试阶段
>   - 在回归中，我们并不需要走所有的用户故事路径，走主要场景的用户故事测试。在写故事时，也可以按照我们认为合适的粒度去写，正是因为我们很容易对故事本身也进行迭代，所以用户故事很适合迭代版本回归中使用来测试。
>   - 这很适用于有时间限制的灰度期间迭代，相对于完成系统的整体功能回归，大大加快了测试进度，并且用户故事又代表了用户最看重的场景路径。
>
> 4. 怎么使用用户故事?
>
> - RD/PM/QA可以快速通过用户故事来以用户的角度对产品进行认知。
>   - QA在回归为了避免出现惯性跑case而忽略产品对于用户的主要功能路径，在使用用户故事时，需要角色带入的方式走用户故事。针对惯性跑case，主要是QA在熟悉产品后，对产品的内容性和体验性问题比较容易忽略，这个是一定要杜绝避免的。
>   - 角色带入方式，就是将自己要测试的用户故事，带入该用户类型的角色、角度对app进行操作，不同用户角色对于产品的侧重不同，如普通用户，对于登录、分享、视频观看，视频内容比较看重；视频制作达人，对于登录，拍摄视频，制作视频等…明确不同用户类型的关注与侧重功能。(注意:新用户也是一个重要角色）
>   - 使用用户故事测试时，一定要保持对app的新鲜与好奇感，当自己是一个真实喜欢、使用者，能更容易的发现核心功能路径下的问题。

### 2、业务流程图

## 三、系统分析

### 1、涉及改动点

> 功能模块、接口（变更、新增）、页面、数据库、配置（TCC、FG）、中间件。。

### 2、系统架构图

### 3、系统链路图

### 4、影响范围分析

## 四、业务分析

### 1、功能测试

#### 1.1 功能逻辑

> 需要覆盖的功能点、业务场景、逻辑分支等等

##### 1.1.1 业务用例设计思路

![微信截图_20250625214025](微信截图_20250625214025.png)

- 用户、场景不遗漏

用户举例：meego中涉及到了很多角色，空间管理员拥有的是最高权限，任何功能均可用，但并不是所有角色均如此，所以涉及到的用户角色都需要验证；

场景举例：新建实例，包括了工作台新建、视图新建、工作项视图新建、数据导入新建、openapi新建等等，如果涉及到了新建实例的测试，那这些场景势必都需要考虑；

- 操作对象不遗漏
- 联动对象不遗漏
- 操作/联动对象的状态机转化梳理覆盖全面
- 枚举值先穷举、再做等价类划分
- 用户可输入的均需要考虑边界

##### 1.1.2 关联&联动场景

#### 1.2 服务端接口

> 接口测试设计：出入参数设计、上下游联测、db & 缓存 & 日志 & 中间件等检查

#### 1.3 前端交互

> 根据UI交互稿页面及各个元素：页面、输入框、下拉组件、展示列表、按钮。。



### 2、数据库/表/字段测试

#### 2.1 数据库表变更

#### 2.2 数据库字段变更

> 字段类型、字段大小

#### 2.3 数据库索引检查

> 索引的完整程度、索引的合理性

#### 2.4 数据一致性

> 表 & 表，库 & 库间的数据一致性

#### 2.5 数据库事务

> 事务生效、事务回滚、事务范围（是否有不可回滚的内容）

#### 2.6 数据库锁

> 锁类型，死锁

### 3、缓存测试

> 缓存key：唯一性、非空
>
> 缓存的更新机制：db & 缓存数据一致性、脏缓存
>
> 缓存的失效机制：主动失效、被动失效
>
> 缓存数据大小、击穿、雪崩
>
> 缓存结构变更：需要有兼容逻辑或者使用新的缓存key 案例：状态流表单丢失问题

### 4、自动化测试

> 测试期间的自动化手段

### 5、配置测试

> 业务数据配置、系统数据配置、切流配置

### 6、幂等测试

> 接口、消息等

### 7、并发测试

> 多个用户对同一个资源的操作
>
> 一个用户几乎同时操作同一个资源多次
>
> 。。。

### 8、异常场景测试

> 业务异常：边界值、非法数据。。
>
> 系统异常：rpc强弱依赖、网络、集群。。

- 用户可输入的地方，均需要考虑异常输入，这里需要收集一些典型问题，作为每次必测内容

比如:最初级的场景，比如一个字段，输入特殊符号，一个emoii，或者一个空格，看是否可用

- 接口的异常输入，需要考虑一些核心的接口字段，是否会存储一些脏数据，或者业务上不允许存储的数据比如：从纯接口参数角度看，

- 极值的考虑

比如：

异常测试可以做的非常深入，但是比较依赖对于技术实现的理解、个人的技术经验的积累等等

再举几个例子

后端常见的有微服务间的强弱依赖、mq的堆积、两个人同时并发操作一个资源等等

前端常见的有数据缓存、接口请求和响应的时序、后端接口异常等等

这些都可能对业务的正确性带来影响，

### 9、安全测试

> 数据、隐私、合规、内容等
>
> 新增的接口必须有安全测试的设计

### 10、兼容性测试

#### 10.1 存量功能兼容

##### 10.1.1 所有需求需要关注的部分

#### 10.2 存量数据兼容

##### 10.2.1 所有需求需要关注的部分

#### 10.3 增量数据兼容

#### 10.4 刷数脚本验证

> 1. 背景介绍
> 2. 刷数据脚本/接口/sql语句测试
> 3. 影响范围测试
> 4. 异常处理方案测试
> 5. 熔断机制测试
> 6. 回滚方案测试
> 7. 结果验证(必须)
> 8. 监控/报警检查
> 9. 线上刷数据安排
> 10. 测试阶段安排&准出标准

#### 10.5 端兼容

> 浏览器、操作系统、设备

### 11、权限相关测试

### 12、性能测试

> 接口链路
>
> 服务端数据模型
>
> 业务场景模型（预估最大数据量做测试）
>
> 需要考虑不同功能配置、配置复杂度对性能的影响。确认最大支持qps的同时，不要忽略基建带宽限制（遇到过事故，qps没到上限但是带宽限制引起数据库主从延迟问题）

- 配置大的场景（针对部分业务）
- 流量压测

### 13、前端内存测试

> 前端内存检査：针对同类型高频操作时，需检查前端内存情况，排除内存泄露风险。
>
> 场景示例：实例详情页反复编辑字段、节点流反复操作节点
>
> ![微信截图_20250625221922](微信截图_20250625221922.png)
>
> 

### 14、埋点测试

### 15、国际化测试

### 16、切流测试

## 五、风险分析

| 风险点 | 解决方案 |
| ------ | -------- |
|        |          |

## 六、测试难点分析

| 思考点 | 常规手段 | 实施方案文档 | 预期/目标 |
| :----: | :------: | :----------: | :-------: |
|        |          |              |           |

## 七、上线

> 灰度、监控、应急

### 1、上线交付标准（准出标准）

> 区分出哪些是交付标准，在交付前我们可以做review
>
> 包含不限于配置变更，多场景分析，功能兼容等

|     交付标准     | 交付项                                                       | 是否准出标准                                                 | 交付角色  |
| :--------------: | :----------------------------------------------------------- | :----------------------------------------------------------- | :-------: |
|     **BUG**      | 所有BUG均closed                                              | 是：所有BUG均修复/验证关闭，若P0/P1 bug未修复仍需上线，需要经过向上审批/报备；若P2/P3 bug末修复仍需上线，需要经过研发&测试owner确认<br />否：存在BUG未修复/验证 |  QA、RD   |
|   **功能验证**   | 完成各阶段测试<br/>全量用例执行100%<br/>上线顺序和回滚方案验收 | 是：完成各阶段测试<br/>否：未完成各阶段测试                  |    QA     |
|  **覆盖率分析**  | 变更覆盖率70%以上<br/>变更覆盖率未覆盖部分分析完成           |                                                              |    QA     |
|   **功能兼容**   | 功能兼容(若有)<br/>数据兼容(若有)                            | 是：所有兼容均验收通过<br/>否：所有兼容未验收通过            |    QA     |
|   **产品验收**   | 体验符合预期<br/>用户功能符合预期<br/>国际化验收<br/>埋点验收 | 是：通过压测等手段，压测结果/改造后的性能结果符合预期；产品功能和迁移&重构前无差别<br />否：性能/用户功能不达预期 | PM、UI/UE |
| **配置变更验证** | 配置变更(FG、TCC等)                                          | 是：所有配置均符合预期<br/>否：所有配置均符合预期            |  RD、QA   |

### 2、上线计划

> QA Owner需要和RD Owner 务必真实且细节的梳理准备上线计划
>
> 如果涉及业务方，需要共同评估考虑

|     上线计划文档     | 请附上线计划文档，包含上线依赖和顺序（包括数据变更，配置变更等） |
| :------------------: | :----------------------------------------------------------- |
| **确认代码合入情况** | 达到上线标准的 feature 无遗漏<br />未达到上线标准(测试验收或各方评估)的feature 不允许合入<br />没有合入非本次需求的代码<br />需上线的 feature 均补充至上线计划文档 |
| **确认上线前置环节** | 是否依赖第三方、上下游上线操作<br />是否涉及黑白名单配置，且配置符合预期<br />是否已明确上线版本、配置、数据变更操作（字段变更、索引变更等）、上线顺序 |
|   **确认影响范围**   | 影响哪些系统，是否已通知相关RD & QA负责人<br/>影响哪些功能，是否已通知相关RD & QA负责人 |
|    **确认可监控**    | 否有监控可以覆盖本次上线变动，是否有预期振幅指标<br/>       业务趋势<br/>       异常报警<br/>       错误码大盘<br/>是否会造成上下游业务阻塞，是否有预期的堆积量化指标<br />监控报警通知人是否单点（要配置多人收到监控） |
|    **确认可灰度**    | 需包含本需求灰度方案。灰度方案几种场景：<br/>服务重构:必须有流量对比方案<br/>无需发布重启应用，即可调整的灰度方案；<br/>灰度策略，必须保证对原有逻辑代码改动为0的原则； |
|    **确认可兼容**    | 发布期间上下游业务的兼容性评估，包括系统发布顺序、新老接口兼容、前端页面与后端服务的兼容，客户端老版本兼容 |
| **确认上线动作操作** | 各类变更过程中，需进行观察：<br/>        业务趋势&核心业务指标大盘<br/>        异常报警<br/>        错误码大盘<br/>        错误日志<br/>        oncall用户反馈<br/>        服务硬件资源、服务状态<br/>开启（限定条件）小流量验证 |

### 3、回滚方案

> ==无回滚方案不上线==
>
> 回滚方案必须含有非版本回切的实现方案，如果回滚对脏数据/出错的数据的处理需要体现
> 需包含改造内容对上游是否是强依赖、是否可降级；如不可降级，需说明原因；如可降级，需填写降级方案

| 回滚方案文档 | 请附回滚方案文档（上线计划和回滚方案可写在一个文档，这里区分是为了更好的提醒和check） |
| :----------: | ------------------------------------------------------------ |
|  **可回滚**  | 后端业务代码/前端代码是否可回滚<br />是否已明确回滚版本、配置、顺序<br/>数据库数据是否可回滚<br/>发现问题后是否有业务开关进行回切，回切能力的验证 |
|  **可降级**  | 是否具备降级、熔断止血应急能力<br/>依赖下游哪些可降级，哪些不可降级、可降级<br/>是否完成降级后的功能分析 |

### 4、灰度方案

> 明确如何进行灰度、灰度节奏、灰度准出标准

|          Check项           | Check项 LIST                                                 |  备注  |
| :------------------------: | :----------------------------------------------------------- | :----: |
|        **灰度方式**        | 明确灰度方式：通过FG控制？通过TCC随机灰度？通过包版本控制？<br/>灰度用户的选取<br/>验证灰度方式有效性：灰度内用户、灰度外用户的预期表现是否正常 | RD、QA |
| **灰度节奏与灰度放量标准** | 灰度节奏：按照怎样的比例、时间周期进行放量？<br/>灰度标准：每一次扩量是基于什么样的数据指标判断可以继续扩大灰度量？ |   PM   |
|      **灰度关注指标**      | 灰度阶段需要关注的指标：<br/>        业务指标<br/>        监控<br />        用反<br />        …… | PM、RD |

## 八、测试分工/排期

> 包括各个模块测试分工，测试估时等















